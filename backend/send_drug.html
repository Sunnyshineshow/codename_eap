<div class="main_page mb-5" style="margin-top:120px;">
    <div class="p-2 mr-5 ml-5">
      <div class="container">

        <h3 class="p-0 m-0 mb-3"><b>Vehicle List</b></h3>
        <br>        
        <div style="width: 100%;height: 1px;border-bottom: 1px dashed #ddd;margin-top: 50px;margin-bottom:30px;"></div>

        <h3 class="p-0 m-0 mb-3"><b>Search Bar</b></h3>

        <div class="row mb-1 d-flex justify-content-start">
          <div class="col-12 col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <form class="form-row" onsubmit="return pre_search();">
              <div class="row d-flex justify-content-center ">
                <div class="col-12 col-sm-12 col-md-6 col-lg-2 col-xl-2 mt-2">
                  <div class="form-group">
                    <input type="text" class="form-control" id="search_idno" placeholder="ID">
                  </div>
                </div>

                <div class="col-12 col-sm-12 col-md-6 col-lg-2 col-xl-2 mt-2">
                  <input type="text" class="form-control" id="search_name" placeholder="ชื่อ">
                </div>

                <div class="col-12 col-sm-12 col-md-6 col-lg-2 col-xl-2 mt-2">
                  <input type="text" class="form-control" id="search_tel" placeholder="หมายเลขโทรศัพท์">
                </div>

                <div class="col-12 col-sm-12 col-md-6 col-lg-2 col-xl-2 mt-2">
                    <input type="text" class="form-control" id="search_carnumber" placeholder="ทะเบียนรถ">
                  </div>

                <div class="col-12 col-sm-12 col-md-6 col-lg-2 col-xl-2 mt-2">
                  <div class="form-group">
                    <button type="submit" class="btn btn-primary border-0">
                      <i class="fas fa-search"></i>
                      Search
                    </button>
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>

        <!-- add patients -->
        <br>

        <div style="width: 100%;height: 1px;border-bottom: 1px dashed #ddd;margin-top: 30px;margin-bottom:30px;"></div>

        <!-- แบ่งหน้า -->
        <div class="row mt-4">
          <div class="col-12 col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <div class="pagination_bar pb-3"></div>
          </div>
        </div>
        <!-- // แบ่งหน้า -->

        <div class="table-responsive mt-2">
          <table class="table table-bordered table-hover show_startpage font-weight-light" >
            <thead class="text-center">
              <tr>
                <th scope="col" class="text-secondary">Profile</th>
                <th scope="col" class="text-secondary">ID</th>
                <th scope="col" class="text-secondary">Display Name</th>
                <th scope="col" class="text-secondary">Tel</th>
                <th scope="col" class="text-secondary">Car Number</th>
                <th scope="col" class="text-secondary">Car type</th>
                <th scope="col" class="text-secondary"> Max Capacity</th>
              </tr>
            </thead>
            <tbody id="row_patientlist" style="display:none;">
              <tr>
                <td class="text-center table-middle">
                  <img src="##vehicle-Picture##" style="max-width:50px;" class="rounded-circle">
                </td>
                <td class="text-center table-middle"># ##vehicle-id##</td>
                <td class="text-center table-middle">##vehicle-Fullname##</td>
                <td class="text-center table-middle">##vehicle-Tel##</td>
                <td class="text-center table-middle">##vehicle-CarNumber##</td>
                <td class="text-center table-middle">##vehicle-car_type##</td>
                <td class="text-center table-middle">##vehicle-maxcapacity##</td>
              </tr>
            </tbody>
            <tbody id="show_patientlist">
              <tr>

              </tr>
            </tbody>
          </table>
        </div>
        <!-- // end table -->

      </div>
    </div>
  </div>
  <script type="text/javascript">
    var template_patient_row = $('#row_patientlist').html();
    var fncsearch;
    $(document).ready(() =>
    {
        // $.getJSON(MAINURL + "/api-backend/admin/get_staff_list",(msg)=>{
        // staff_name = hash_replace($("#staff_list").html(), 'staff', msg)
        // $("#staff_list_showing").html(staff_name);
        // })
    })

    function pre_search(){
      var searchdata ={}
      if ($('#search_name').val() !== "") {
        searchdata.findname = $('#search_name').val()
      }

      if ($('#search_idno').val() !== "") {
        searchdata.find_id =  $('#search_idno').val()
      }

      if ($('#search_tel').val() !== "") {
        searchdata.find_tel= $('#search_tel').val()
      }

      if ($('#search_carnumber').val() !== "") {
        searchdata.find_carnumber =  $('#search_carnumber').val()
      }
      var searchdata ={};
      fncsearch({search:searchdata});
      return false;
    }
    function refreshpage(rawdata) {
      console.log("GLOBAL_USER",GLOBAL_USER)

      var search_setting = {
        posturl: '/api-backend/admin/treatment_medic_form',
        paginationDIV: $('.pagination_bar'),
        pagesize: 10,
        showfunction: show_patient_list,
        limit: 20,
        search: {}
      }


      var pagenumber = getParameterByName('page', window.location.search);
      if (pagenumber > 1) {
        search_setting.page = pagenumber;
      }
      // console.log('SEARCH ', search_setting);
      fncsearch = ADV_search(search_setting); // Defult always search at first
      return false;
    }

    function show_patient_list(objdata, totalrecord) {
      // console.log('objdata', objdata);
      if (objdata.result && totalrecord > 0) {
        working.patient = objdata.obj;

        console.log("Object Income here!")
        console.log(objdata.obj)

        var html_row = hash_replace(template_patient_row, 'medic', objdata.obj)
        $("#show_patientlist").html(html_row);
        // $('.show_startpage').show('slow');

      } else {
        $("#show_patientlist").html('<tr><td colspan="100%" class="text-center"><span class="text-sub">Data not found</span></td></tr>');
      }
    }

    function view_symptom(patient_id) {

      go2View("patient?id=" + patient_id)

    }

    function appointment(patient_id) {

      go2View("appoint_patient?id=" + patient_id)

    }

    function settingpatient(dataid) {
      working.active_patientid = dataid;
      go2View('patient-edit');
    }

    function AddDataPatient(){
      go2View('patient_form');
    }

    function date_diff(date1) {
      let dateOnly = new Date()
      console.log(dateOnly)

      let date2 = Date.parse(new Date(dateOnly.getFullYear(), dateOnly.getMonth(), dateOnly.getDate()))
      console.log(new Date(date2))

      return parseInt((date2 - date1) / 86400000)
    }

    function OpenSearchBox(id)
    {
        if (document.getElementById(id).style.display == "none")
        {
            document.getElementById(id).style.display = "block"
        }
        else
        {
            document.getElementById(id).style.display = "none"
        }

    }


</script>
