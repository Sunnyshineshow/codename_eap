<div class="main_page mb-5" style="margin-top:120px;">
    <div class="p-2 mr-5 ml-5">
      <div class="container">

        <h3 class="p-0 m-0 mb-3"><b>Send drug</b></h3>
        <br>        
        <div style="width: 100%;height: 1px;border-bottom: 1px dashed #ddd;margin-top: 50px;margin-bottom:30px;"></div>            
        <br>         

        <!-- แบ่งหน้า -->
        <div class="row mt-4">
          <div class="col-12 col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <div class="pagination_bar pb-3"></div>
          </div>
        </div>
        <!-- // แบ่งหน้า -->

        <div class="table-responsive mt-2">
          <table class="table table-bordered table-hover show_startpage font-weight-light" >
            <thead class="text-center">             
              <tr>
                <th scope="col" class="text-secondary">No</th>
                <th scope="col" class="text-secondary">Date</th>
                <th scope="col" class="text-secondary">Display Name</th>
                <th scope="col" class="text-secondary">Citizen ID</th>
                <th scope="col" class="text-secondary">Tel</th>
                <th scope="col" class="text-secondary">O2,pulse</th>
                <th scope="col" class="text-secondary">มากกว่า 90 kg (54 เม็ด)</th>
                <th scope="col" class="text-secondary">น้อยกว่า 90 kg (64 เม็ด)</th>
                <th scope="col" class="text-secondary">เคยได้แล้ว</th>
                <th scope="col" class="text-secondary">ตั้งครรภ์</th>
                <th scope="col" class="text-secondary">มีโรคตับ</th>
                <th scope="col" class="text-secondary">จำนวน xray</th>
                <th scope="col" class="text-secondary">ชื่อผู้ปฎิบัติ</th>

              </tr>              
            </thead>
            <tbody id="row_patientlist" style="display:none;">
              <tr>
                <td class="text-center table-middle"># ##patient-id##</td>
                <td class="text-center table-middle"># ##vehicle-id##</td>
                <td class="text-center table-middle">##vehicle-Fullname##</td>
                <td class="text-center table-middle">##vehicle-Tel##</td>
                <td class="text-center table-middle">##vehicle-CarNumber##</td>
                <td class="text-center table-middle">##vehicle-car_type##</td>
                <td class="text-center table-middle">##vehicle-maxcapacity##</td>
              </tr>
            </tbody>
            <tbody id="show_patientlist">
              <tr>

              </tr>
            </tbody>
          </table>
        </div>
        <!-- // end table -->

      </div>
    </div>
  </div>
  <script type="text/javascript">
    var template_patient_row = $('#row_patientlist').html();
    var fncsearch;   
    /*
    function pre_search(){
      var searchdata ={}     
     
      var searchdata ={};
      fncsearch({search:searchdata});
      return false;
    }
    */
    function refreshpage(rawdata) {
      console.log("GLOBAL_USER",GLOBAL_USER)

      var search_setting = {
        posturl: '/api-backend/admin/treatment_medic_form',
        paginationDIV: $('.pagination_bar'),
        pagesize: 10,
        showfunction: show_patient_list,
        limit: 20,
        search: {date: Math.floor(new Date() / 1000)}
      }    

      var pagenumber = getParameterByName('page', window.location.search);
      if (pagenumber > 1) {
        search_setting.page = pagenumber;
      }
      // console.log('SEARCH ', search_setting);
      fncsearch = ADV_search(search_setting); // Defult always search at first
      return false;
    }

    function show_patient_list(objdata, totalrecord) {
      console.log("Check!")
      console.log(objdata.obj)
      if (objdata.result && totalrecord > 0) {
        working.patient = objdata.obj;

        console.log("Object Income here!")
        console.log(objdata.obj)

        var html_row = hash_replace(template_patient_row, 'patient', objdata.obj)
        $("#show_patientlist").html(html_row);
        // $('.show_startpage').show('slow');

      } else {
        $("#show_patientlist").html('<tr><td colspan="100%" class="text-center"><span class="text-sub">Data not found</span></td></tr>');
      }
    }

    
    function date_diff(date1) {
      let dateOnly = new Date()
      console.log(dateOnly)

      let date2 = Date.parse(new Date(dateOnly.getFullYear(), dateOnly.getMonth(), dateOnly.getDate()))
      console.log(new Date(date2))

      return parseInt((date2 - date1) / 86400000)
    }

    function OpenSearchBox(id)
    {
        if (document.getElementById(id).style.display == "none")
        {
            document.getElementById(id).style.display = "block"
        }
        else
        {
            document.getElementById(id).style.display = "none"
        }

    }


</script>
